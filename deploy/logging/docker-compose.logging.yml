# ===========================================
# Docker 日志配置示例
# 此文件展示推荐的日志配置
# 实际配置已集成到 docker-compose.prod.yml 和 docker-compose.staging.yml 中
# ===========================================

# 日志驱动配置说明:
# 
# json-file 驱动参数:
#   max-size: 单个日志文件最大大小
#   max-file: 保留的日志文件数量
#
# 示例配置:
#   max-size: "100m"  # 100MB
#   max-file: "5"     # 保留 5 个文件
#   总计最大: 500MB 日志空间

# 使用方法:
# 在 docker-compose.yml 的 service 定义中添加:
#
# services:
#   backend:
#     logging:
#       driver: "json-file"
#       options:
#         max-size: "100m"
#         max-file: "5"

# ===========================================
# 各服务推荐的日志配置
# ===========================================

x-logging-backend: &logging-backend
  driver: "json-file"
  options:
    max-size: "100m"
    max-file: "5"
    # 总计: 500MB

x-logging-frontend: &logging-frontend
  driver: "json-file"
  options:
    max-size: "50m"
    max-file: "3"
    # 总计: 150MB

x-logging-nginx: &logging-nginx
  driver: "json-file"
  options:
    max-size: "100m"
    max-file: "5"
    # 总计: 500MB

# ===========================================
# 日志查看命令
# ===========================================
#
# 查看实时日志:
#   docker compose -f docker-compose.prod.yml logs -f backend-prod
#   docker compose -f docker-compose.prod.yml logs -f --tail=100
#
# 查看特定容器日志:
#   docker logs multimo-backend-prod
#   docker logs --since 1h multimo-backend-prod
#   docker logs --tail 200 multimo-backend-prod
#
# 日志文件位置:
#   /var/lib/docker/containers/<container-id>/<container-id>-json.log
#
# 清理日志 (需要 root 权限):
#   truncate -s 0 /var/lib/docker/containers/<container-id>/*-json.log
#
# ===========================================
# 日志轮转配置 (可选)
# ===========================================
#
# 如果需要更高级的日志管理，可以考虑:
# 1. 使用 syslog 驱动发送到远程日志服务器
# 2. 使用 fluentd 驱动发送到 ELK Stack
# 3. 使用阿里云日志服务 (SLS)
#
# syslog 示例:
#   logging:
#     driver: syslog
#     options:
#       syslog-address: "tcp://logs.example.com:514"
#       tag: "multimo/{{.Name}}"
