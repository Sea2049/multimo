# æµ‹è¯•è¦†ç›–ç‡æå‡è®¡åˆ’

## ğŸ“Š å½“å‰çŠ¶æ€

- **æ€»ä½“è¦†ç›–ç‡**: 19%
- **ç›®æ ‡è¦†ç›–ç‡**: 40% (çŸ­æœŸ) â†’ 60% (ä¸­æœŸ) â†’ 70% (é•¿æœŸ)
- **é¢„è®¡æå‡**: +21% (è¾¾åˆ° 40%)

---

## ğŸ¯ P0: API å±‚é›†æˆæµ‹è¯• (é¢„è®¡æå‡ 10%)

### 1. åˆ›å»º `backend/tests/test_api_graph.py`

æµ‹è¯•å›¾è°± API ç«¯ç‚¹:
- `GET /api/graph/project/<project_id>` - è·å–é¡¹ç›®è¯¦æƒ…
- `GET /api/graph/project/list` - åˆ—å‡ºæ‰€æœ‰é¡¹ç›®
- `DELETE /api/graph/project/<project_id>` - åˆ é™¤é¡¹ç›®
- `POST /api/graph/ontology/generate` - ç”Ÿæˆæœ¬ä½“
- `POST /api/graph/extract` - æå–å®ä½“
- `POST /api/graph/build` - æ„å»ºå›¾è°±
- `GET /api/graph/<graph_id>` - è·å–å›¾è°±
- `GET /api/graph/<graph_id>/export` - å¯¼å‡ºå›¾è°±

### 2. åˆ›å»º `backend/tests/test_api_simulation.py`

æµ‹è¯•æ¨¡æ‹Ÿ API ç«¯ç‚¹:
- `POST /api/simulation/create` - åˆ›å»ºæ¨¡æ‹Ÿ
- `POST /api/simulation/prepare` - å‡†å¤‡ç¯å¢ƒ
- `POST /api/simulation/start` - å¯åŠ¨æ¨¡æ‹Ÿ
- `GET /api/simulation/status` - æŸ¥è¯¢çŠ¶æ€
- `POST /api/simulation/stop` - åœæ­¢æ¨¡æ‹Ÿ
- `GET /api/simulation/history` - è·å–å†å²
- è‡ªåŠ¨é©¾é©¶æ¨¡å¼ç›¸å…³ç«¯ç‚¹

### 3. åˆ›å»º `backend/tests/test_api_report.py`

æµ‹è¯•æŠ¥å‘Š API ç«¯ç‚¹:
- `POST /api/report/generate` - ç”ŸæˆæŠ¥å‘Š
- `GET /api/report/<simulation_id>` - è·å–æŠ¥å‘Š
- `GET /api/report/<simulation_id>/markdown` - Markdown æ ¼å¼
- `GET /api/report/list` - åˆ—å‡ºæ‰€æœ‰æŠ¥å‘Š

### 4. æ›´æ–° `backend/tests/conftest.py`

æ·»åŠ  Flask æµ‹è¯•å®¢æˆ·ç«¯ fixtures:
```python
@pytest.fixture
def app():
    """åˆ›å»ºæµ‹è¯•åº”ç”¨"""
    
@pytest.fixture
def client(app):
    """åˆ›å»ºæµ‹è¯•å®¢æˆ·ç«¯"""
    
@pytest.fixture
def mock_llm_client():
    """Mock LLM å®¢æˆ·ç«¯"""
```

---

## ğŸ¯ P1: æ ¸å¿ƒæœåŠ¡å•å…ƒæµ‹è¯• (é¢„è®¡æå‡ 15%)

### 1. æ‰©å±• `backend/tests/test_simulation_runner.py`

æ–°å¢æµ‹è¯•ç”¨ä¾‹:
- `test_pause_simulation` - æš‚åœæ¨¡æ‹Ÿ
- `test_resume_simulation` - æ¢å¤æ¨¡æ‹Ÿ
- `test_get_simulation_logs` - è·å–æ—¥å¿—
- `test_get_round_summary` - è·å–è½®æ¬¡æ‘˜è¦
- `test_concurrent_simulations` - å¹¶å‘æ¨¡æ‹Ÿ
- `test_error_handling` - é”™è¯¯å¤„ç†
- `test_state_persistence` - çŠ¶æ€æŒä¹…åŒ–

### 2. åˆ›å»º `backend/tests/test_report_agent.py`

æµ‹è¯•æŠ¥å‘Šæ™ºèƒ½ä½“:
- `test_report_logger_init` - æ—¥å¿—è®°å½•å™¨åˆå§‹åŒ–
- `test_report_logger_log` - æ—¥å¿—è®°å½•
- `test_report_agent_init` - æ™ºèƒ½ä½“åˆå§‹åŒ–
- `test_generate_outline` - ç”Ÿæˆå¤§çº²
- `test_generate_section` - ç”Ÿæˆç« èŠ‚
- `test_tool_calls` - å·¥å…·è°ƒç”¨
- `test_react_loop` - ReACT å¾ªç¯
- `test_error_recovery` - é”™è¯¯æ¢å¤

### 3. åˆ›å»º `backend/tests/test_auto_pilot_manager.py`

æµ‹è¯•è‡ªåŠ¨é©¾é©¶ç®¡ç†å™¨:
- `test_auto_pilot_state_init` - çŠ¶æ€åˆå§‹åŒ–
- `test_mode_switch` - æ¨¡å¼åˆ‡æ¢
- `test_step_transitions` - æ­¥éª¤è½¬æ¢
- `test_pause_resume` - æš‚åœ/æ¢å¤
- `test_error_handling` - é”™è¯¯å¤„ç†
- `test_state_persistence` - çŠ¶æ€æŒä¹…åŒ–
- `test_auto_prepare` - è‡ªåŠ¨å‡†å¤‡
- `test_auto_start` - è‡ªåŠ¨å¯åŠ¨
- `test_auto_monitor` - è‡ªåŠ¨ç›‘æ§
- `test_auto_report` - è‡ªåŠ¨æŠ¥å‘Š

### 4. åˆ›å»º `backend/tests/test_simulation_manager.py`

æµ‹è¯•æ¨¡æ‹Ÿç®¡ç†å™¨:
- `test_create_simulation` - åˆ›å»ºæ¨¡æ‹Ÿ
- `test_get_simulation` - è·å–æ¨¡æ‹Ÿ
- `test_update_simulation_status` - æ›´æ–°çŠ¶æ€
- `test_list_simulations` - åˆ—å‡ºæ¨¡æ‹Ÿ
- `test_delete_simulation` - åˆ é™¤æ¨¡æ‹Ÿ

---

## ğŸ¯ P1: ç«¯åˆ°ç«¯æµ‹è¯• (é¢„è®¡æå‡ 5%)

### åˆ›å»º `backend/tests/test_e2e_workflow.py`

å®Œæ•´å·¥ä½œæµæµ‹è¯•:
- `test_graph_build_workflow` - å›¾è°±æ„å»ºæµç¨‹
- `test_simulation_workflow` - æ¨¡æ‹Ÿè¿è¡Œæµç¨‹
- `test_report_generation_workflow` - æŠ¥å‘Šç”Ÿæˆæµç¨‹
- `test_auto_pilot_workflow` - è‡ªåŠ¨é©¾é©¶æµç¨‹

---

## ğŸ¯ P2: å·¥å…·å‡½æ•°æµ‹è¯• (é¢„è®¡æå‡ 5%)

### 1. åˆ›å»º `backend/tests/test_validators.py`

æµ‹è¯•éªŒè¯å™¨:
- `test_validate_file_upload` - æ–‡ä»¶ä¸Šä¼ éªŒè¯
- `test_sanitize_filename` - æ–‡ä»¶åæ¸…ç†
- `test_validate_no_sql_injection` - SQL æ³¨å…¥æ£€æµ‹
- `test_sanitize_string` - å­—ç¬¦ä¸²æ¸…ç†
- `test_validate_xss` - XSS æ£€æµ‹

### 2. åˆ›å»º `backend/tests/test_file_parser.py`

æµ‹è¯•æ–‡ä»¶è§£æå™¨:
- `test_parse_pdf` - PDF è§£æ
- `test_parse_markdown` - Markdown è§£æ
- `test_parse_txt` - TXT è§£æ
- `test_invalid_file` - æ— æ•ˆæ–‡ä»¶å¤„ç†

### 3. åˆ›å»º `backend/tests/test_llm_client.py`

æµ‹è¯• LLM å®¢æˆ·ç«¯:
- `test_init_with_api_key` - åˆå§‹åŒ–
- `test_chat_completion` - èŠå¤©å®Œæˆ
- `test_stream_completion` - æµå¼å®Œæˆ
- `test_error_handling` - é”™è¯¯å¤„ç†
- `test_retry_logic` - é‡è¯•é€»è¾‘

### 4. åˆ›å»º `backend/tests/test_retry.py`

æµ‹è¯•é‡è¯•å·¥å…·:
- `test_retry_success` - é‡è¯•æˆåŠŸ
- `test_retry_max_attempts` - æœ€å¤§é‡è¯•æ¬¡æ•°
- `test_retry_with_backoff` - é€€é¿ç­–ç•¥

---

## ğŸ“ æ–°å¢æµ‹è¯•æ–‡ä»¶æ¸…å•

```
backend/tests/
â”œâ”€â”€ conftest.py              # æ›´æ–°: æ·»åŠ  Flask æµ‹è¯• fixtures
â”œâ”€â”€ test_api_graph.py        # æ–°å¢: å›¾è°± API æµ‹è¯• (~15 ç”¨ä¾‹)
â”œâ”€â”€ test_api_simulation.py   # æ–°å¢: æ¨¡æ‹Ÿ API æµ‹è¯• (~20 ç”¨ä¾‹)
â”œâ”€â”€ test_api_report.py       # æ–°å¢: æŠ¥å‘Š API æµ‹è¯• (~10 ç”¨ä¾‹)
â”œâ”€â”€ test_simulation_runner.py # æ‰©å±•: æ–°å¢ ~10 ç”¨ä¾‹
â”œâ”€â”€ test_report_agent.py     # æ–°å¢: æŠ¥å‘Šæ™ºèƒ½ä½“æµ‹è¯• (~15 ç”¨ä¾‹)
â”œâ”€â”€ test_auto_pilot_manager.py # æ–°å¢: è‡ªåŠ¨é©¾é©¶æµ‹è¯• (~15 ç”¨ä¾‹)
â”œâ”€â”€ test_simulation_manager.py # æ–°å¢: æ¨¡æ‹Ÿç®¡ç†å™¨æµ‹è¯• (~10 ç”¨ä¾‹)
â”œâ”€â”€ test_e2e_workflow.py     # æ–°å¢: ç«¯åˆ°ç«¯æµ‹è¯• (~5 ç”¨ä¾‹)
â”œâ”€â”€ test_validators.py       # æ–°å¢: éªŒè¯å™¨æµ‹è¯• (~10 ç”¨ä¾‹)
â”œâ”€â”€ test_file_parser.py      # æ–°å¢: æ–‡ä»¶è§£æå™¨æµ‹è¯• (~8 ç”¨ä¾‹)
â”œâ”€â”€ test_llm_client.py       # æ–°å¢: LLM å®¢æˆ·ç«¯æµ‹è¯• (~8 ç”¨ä¾‹)
â””â”€â”€ test_retry.py            # æ–°å¢: é‡è¯•å·¥å…·æµ‹è¯• (~5 ç”¨ä¾‹)
```

**é¢„è®¡æ–°å¢æµ‹è¯•ç”¨ä¾‹**: ~130 ä¸ª

---

## â±ï¸ æ‰§è¡Œè®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µ: P0 - API é›†æˆæµ‹è¯• (é¢„è®¡ 1-2 å°æ—¶)
1. æ›´æ–° conftest.py æ·»åŠ  Flask æµ‹è¯• fixtures
2. åˆ›å»º test_api_graph.py
3. åˆ›å»º test_api_simulation.py
4. åˆ›å»º test_api_report.py
5. è¿è¡Œæµ‹è¯•éªŒè¯

### ç¬¬äºŒé˜¶æ®µ: P1 - æ ¸å¿ƒæœåŠ¡æµ‹è¯• (é¢„è®¡ 2-3 å°æ—¶)
1. æ‰©å±• test_simulation_runner.py
2. åˆ›å»º test_report_agent.py
3. åˆ›å»º test_auto_pilot_manager.py
4. åˆ›å»º test_simulation_manager.py
5. åˆ›å»º test_e2e_workflow.py

### ç¬¬ä¸‰é˜¶æ®µ: P2 - å·¥å…·å‡½æ•°æµ‹è¯• (é¢„è®¡ 1 å°æ—¶)
1. åˆ›å»º test_validators.py
2. åˆ›å»º test_file_parser.py
3. åˆ›å»º test_llm_client.py
4. åˆ›å»º test_retry.py

### ç¬¬å››é˜¶æ®µ: éªŒè¯å’Œä¼˜åŒ– (é¢„è®¡ 30 åˆ†é’Ÿ)
1. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
2. ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
3. ä¿®å¤å¤±è´¥çš„æµ‹è¯•
4. æ›´æ–°æ–‡æ¡£

---

## âœ… æˆåŠŸæ ‡å‡†

- [ ] æ‰€æœ‰æ–°å¢æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- [ ] ä»£ç è¦†ç›–ç‡è¾¾åˆ° 40%+
- [ ] API å±‚è¦†ç›–ç‡è¾¾åˆ° 50%+
- [ ] æ ¸å¿ƒæœåŠ¡è¦†ç›–ç‡è¾¾åˆ° 40%+
- [ ] æ— ä¸¥é‡æµ‹è¯•å¤±è´¥
- [ ] æ›´æ–° CODE_DIRECTORY.md å’Œ TESTING.md

æ˜¯å¦å¼€å§‹æ‰§è¡Œæ­¤è®¡åˆ’?